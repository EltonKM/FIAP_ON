SELECT
   A.TP_LOCALIZACAO
  ,A.TP_DEPENDENCIA
  ,A.NO_REGIAO
  ,A.NO_UF
  ,SUM(B.NU_PARTICIPANTES) AS NU_PARTICIPANTES_ENEM
  ,AVG(b.NU_MEDIA_CN) AS MEDIA_CIENCIAS_NATUREZA
  ,AVG(B.NU_MEDIA_CH) AS MEDIA_CIENCIAS_HUMANAS
  ,AVG(B.NU_MEDIA_LP) AS MEDIA_LINGUA_PORTUGUESA
  ,AVG(B.NU_MEDIA_MT) AS MEDIA_MATEMATICA
  ,AVG(B.NU_MEDIA_RED) AS MEDIA_REDACAO
  ,C.IN_AGUA_INEXISTENTE
  ,C.IN_ENERGIA_INEXISTENTE
  ,C.IN_ESGOTO_INEXISTENTE
  ,C.IN_BANHEIRO
  ,C.IN_BIBLIOTECA
  ,C.IN_COZINHA
  ,C.IN_LABORATORIO_CIENCIAS
  ,C.IN_LABORATORIO_INFORMATICA
  ,C.IN_QUADRA_ESPORTES
  ,C.IN_ACESSIBILIDADE_CORRIMAO
  ,C.IN_ACESSIBILIDADE_RAMPAS
  ,C.IN_ACESSIBILIDADE_INEXISTENTE
  ,C.IN_DESKTOP_ALUNO
  ,C.IN_TABLET_ALUNO
  ,C.IN_INTERNET
  ,C.IN_INTERNET_ALUNOS
FROM
TB_ESCOLAS A
LEFT JOIN TB_ESCOLAS_ENEM B
  ON A.CO_ENTIDADE = B.CO_ESCOLA_EDUCACENSO
LEFT JOIN TB_ESCOLAS_INFRA C
  ON A.CO_ENTIDADE = C.CO_ENTIDADE
GROUP BY
   A.TP_LOCALIZACAO
  ,A.TP_DEPENDENCIA
  ,A.NO_REGIAO
  ,A.NO_UF
  ,C.IN_AGUA_INEXISTENTE
  ,C.IN_ENERGIA_INEXISTENTE
  ,C.IN_ESGOTO_INEXISTENTE
  ,C.IN_BANHEIRO
  ,C.IN_BIBLIOTECA
  ,C.IN_COZINHA
  ,C.IN_LABORATORIO_CIENCIAS
  ,C.IN_LABORATORIO_INFORMATICA
  ,C.IN_QUADRA_ESPORTES
  ,C.IN_ACESSIBILIDADE_CORRIMAO
  ,C.IN_ACESSIBILIDADE_RAMPAS
  ,C.IN_ACESSIBILIDADE_INEXISTENTE
  ,C.IN_DESKTOP_ALUNO
  ,C.IN_TABLET_ALUNO
  ,C.IN_INTERNET
  ,C.IN_INTERNET_ALUNOS
;
